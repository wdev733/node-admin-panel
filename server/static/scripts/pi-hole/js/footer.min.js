/*! pi1 - v1.0.0 -  2017 - 01 - 25  */
function piholeChanged(a){const b=$("#status"),c=$("#pihole-enable"),d=$("#pihole-disable");switch(a){case"enabled":b.html("<i class='fa fa-circle' style='color:#7FFF00'></i> Active"),c.hide(),d.show(),d.removeClass("active");break;case"disabled":b.html("<i class='fa fa-circle' style='color:#FF0000'></i> Offline"),c.show(),d.hide()}}function piholeChange(a,b){const c=encodeURIComponent($("#token").html());var d;switch(a){case"enable":d=$("#flip-status-enable"),d.html("<i class='fa fa-spinner'> </i>"),$.post("api/enable",{token:c},function(a){"enabled"===a.status&&(d.html(""),piholeChanged("enabled"))});break;case"disable":d=$("#flip-status-disable"),d.html("<i class='fa fa-spinner'> </i>"),$.post("api/disable",{token:c,time:b},function(a){"disabled"===a.status&&(d.html(""),piholeChanged("disabled"))},"json")}}function versionCompare(a,b){if(typeof a+typeof b!="stringstring")return!1;if("vDev"===a)return 1;for(var c=a.split("v"),d=b.split("v"),e=c[c.length-1].split("."),f=d[d.length-1].split("."),g=0,h=Math.max(e.length,f.length);g<h;g++){if(e[g]&&!f[g]&&parseInt(e[g])>0||parseInt(e[g])>parseInt(f[g]))return 1;if(f[g]&&!e[g]&&parseInt(f[g])>0||parseInt(e[g])<parseInt(f[g]))return-1}return 0}function updateSessionTimer(){start=new Date,start.setSeconds(start.getSeconds()+sessionvalidity)}$("#dropdown-menu a").on("click",function(a){$(this).parent().toggleClass("open")}),$("body").on("click",function(a){$("#dropdown-menu").is(a.target)||0!==$("#dropdown-menu").has(a.target).length||$("#dropdown-menu").removeClass("open")}),$("#pihole-enable").on("click",function(a){a.preventDefault(),piholeChange("enable","")}),$("#pihole-disable-permanently").on("click",function(a){a.preventDefault(),piholeChange("disable","0")}),$("#pihole-disable-10s").on("click",function(a){a.preventDefault(),piholeChange("disable","10"),setTimeout(function(){piholeChanged("enabled")},1e4)}),$("#pihole-disable-30s").on("click",function(a){a.preventDefault(),piholeChange("disable","30"),setTimeout(function(){piholeChanged("enabled")},3e4)}),$("#pihole-disable-5m").on("click",function(a){a.preventDefault(),piholeChange("disable","300"),setTimeout(function(){piholeChanged("enabled")},3e5)});var piholeVersion=$("#piholeVersion").html(),webVersion=$("#webVersion").html();$.getJSON("https://api.github.com/repos/pi-hole/pi-hole/releases/latest",function(a){versionCompare(piholeVersion,a.tag_name.slice(1))<0&&($("#piholeVersion").html($("#piholeVersion").text()+'<a class="alert-link" href="https://github.com/pi-hole/pi-hole/releases">(Update available!)</a>'),$("#alPiholeUpdate").show())}),$.getJSON("https://api.github.com/repos/pi-hole/AdminLTE/releases/latest",function(a){versionCompare(webVersion,a.tag_name.slice(1))<0&&($("#webVersion").html($("#webVersion").text()+'<a class="alert-link" href="https://github.com/pi-hole/adminLTE/releases">(Update available!)</a>'),$("#alWebUpdate").show())}),versionCompare(piholeVersion,"v2.7")<0&&alert("Pi-hole needs to be updated to at least v2.7 before you can use features such as whitelisting/blacklisting from this web interface!");var sessionvalidity=parseInt(document.getElementById("sessiontimercounter").textContent),start=new Date;sessionvalidity>0?(updateSessionTimer(),setInterval(function(){var a=new Date,b=(start-a)/1e3,c=Math.floor(b/60);c<10&&(c="0"+c);var d=Math.floor(b%60);d<10&&(d="0"+d),b>0?document.getElementById("sessiontimercounter").textContent=c+":"+d:document.getElementById("sessiontimercounter").textContent="-- : --"},1e3)):document.getElementById("sessiontimer").style.display="none",versionCompare(piholeVersion,"v2.9.5")<1&&$("#btnSearchExact").hide(),$(document).keypress(function(a){(10===a.keyCode||13===a.keyCode)&&a.ctrlKey&&$("#loginpw").is(":focus")&&($("#loginform").attr("action","settings.php"),$("#loginform").submit())});