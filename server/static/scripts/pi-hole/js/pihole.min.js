/*! pi1 - v1.0.0 -  2017 - 01 - 25  */
!function(a,b,c){"use strict";if("undefined"==typeof d){var d={};const e={enable:function(){},disable:function(){}};d.api={},d.api.data={get:function(a){return b.ajax({url:"/api/data",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},method:"get",dataType:"json",data:a})}},d.api.list={get:function(a){return b.ajax({url:"/api/list",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},method:"get",dataType:"json",data:{list:a}})},post:function(a,c){return b.ajax({url:"/api/list",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},method:"post",dataType:"json",data:{domain:c,list:a,token:d.helper.getApiToken()}})},delete:function(a,c){return b.ajax({url:"/api/list",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},method:"delete",dataType:"json",data:{domain:c,list:a,token:d.helper.getApiToken()}})}},d.taillog=function(){const a=["dns"];var b,c={dns:[],error:[],open:[]},d=!1;const e=function(a,b){c[a].forEach(function(a){a(JSON.parse(b.data))})},f=function(a){d=!1,e("error",a)},g=function(a){e("dns",a)},h=function(a){},i=function(){d=!0,e("open")};var j={};return j.subscribe=function(b,d){return a.indexOf(b)>=0&&c[b].push(d),function(){j.unsubscribe(d)}},j.unsubscribe=function(b,d){if(a.indexOf(b)>=0){const e=c[b].indexOf(d);e!==-1&&c[b].splice(e,1)}},j.listen=function(){d||(d=!0,b=new EventSource("/api/taillog",{withcredentials:!0}),b.onerror=f,b.onmessage=h,b.addEventListener("dns",g,!1),b.onopen=i)},j}(),d.helper=function(){var a,d={};return d.getApiToken=function(){return a===c&&(a=b("#token").html()),a},d.timestampToFrameIdx=function(a,b){var c;c="date"==typeof a?a:new Date(a);const d=c.getHours(),e=c.getMinutes();return Math.floor((60*d+e)/b)},d}(),d.settings=e,a.pihole=d}}(window,$);