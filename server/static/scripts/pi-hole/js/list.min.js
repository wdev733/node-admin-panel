/*! pi1 - v1.0.0 -  2017 - 01 - 26  */
$.ajaxSetup({cache:!1});var domainList={};!function(a){const b=$("#token").html(),c=$("#list-type").html(),d="white"===c?"Whitelist":"Blacklist",e=$("#alInfo"),f=$("#alSuccess"),g=$("#alFailure"),h=$("#domain"),i=$("#list"),j={success:function(b){b.indexOf("not a valid argument")>=0||b.indexOf("is not a valid domain")>=0?(g.show(),g.delay(1e3).fadeOut(2e3,function(){g.hide()}),e.delay(1e3).fadeOut(2e3,function(){e.hide()})):(f.show(),f.delay(1e3).fadeOut(2e3,function(){f.hide()}),e.delay(1e3).fadeOut(2e3,function(){e.hide()}),h.val(""),a.refresh(!0))},error:function(a,b){g.show(),g.delay(1e3).fadeOut(2e3,function(){g.hide()}),e.delay(1e3).fadeOut(2e3,function(){e.hide()})}},k={error:function(a,b){h.show({queue:!0}),alert("Failed to remove the domain!")},success:function(a){0===a.length&&h.remove()}},l={success:function(b){i.html(""),0===b.length?i.html('<div class="alert alert-info" role="alert">Your '+d+" is empty!</div>"):b.forEach(function(b,c){i.append('<li id="'+c+'" class="list-group-item clearfix">'+b+'<button class="btn btn-danger btn-xs pull-right" type="button"><span class="glyphicon glyphicon-trash"></span></button></li>'),$("#list #"+c).on("click","button",function(){a.sub(c,b)})}),i.fadeIn("fast")},error:function(a,b){$("#alFailure").show()}};a.add=function(){0!==h.val().length&&(e.show(),f.hide(),g.hide(),$.ajax({url:"api/list",method:"post",data:{domain:h.val(),list:c,token:b},success:j.success,error:j.error}))},a.sub=function(a,d){h.hide("highlight"),$.ajax({url:"api/list",method:"delete",data:{domain:d,list:c,token:b},success:k.success,error:k.error})},a.refresh=function(a){a&&i.fadeOut(100),$.ajax({url:"/api/list",method:"get",data:{list:c},success:l.success,error:l.error})}}(domainList),window.onload=domainList.refresh(!1),$(document).keypress(function(a){13===a.which&&$("#domain").is(":focus")&&domainList.add()}),$("#btnAdd").on("click",function(){domainList.add()}),$("#btnRefresh").on("click",function(){domainList.refresh(!0)}),$(function(){$("[data-hide]").on("click",function(){$(this).closest("."+$(this).attr("data-hide")).hide()})});