/*! pi1 - v1.0.0 -  2017 - 01 - 24  */
var taillogWatcher={};!function(taillog){const supportedEvents=["dns"];var evSource,callbacks={dns:[],error:[],open:[]},isListening=!1;const emit=function(name,event){callbacks[name].forEach(function(callback){callback(JSON.parse(event.data))})},onError=function(error){emit("error",error)},onDnsEvent=function(event){emit("dns",event)},onMessage=function(data){},onOpen=function(){emit("open")};taillog.on=function(event,callback){return supportedEvents.indexOf(event)>=0&&callbacks[event].push(callback),function(){taillog.off(callback)}},taillog.off=function(event,callback){if(supportedEvents.indexOf(event)>=0){const callbackIdx=callbacks[event].indexOf(callback);callbackIdx!==-1&&delete callbacks[event][callbackIdx]}},taillog.listen=function(){isListening||(isListening=!0,evSource=new EventSource("/api/taillog",{withcredentials:!0}),evSource.onerror=onError,evSource.onmessage=onMessage,evSource.addEventListener("dns",onDnsEvent,!1),evSource.onopen=onOpen)}}(taillogWatcher),taillogWatcher.listen();